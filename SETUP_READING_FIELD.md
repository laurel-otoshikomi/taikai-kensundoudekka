# 読み仮名フィールド セットアップ手順

## 📝 概要
選手名の読み仮名（ひらがな）検索機能を有効化するためのセットアップ手順です。

## 🎯 機能
- 「たなか」で「田中」を検索できる
- 「サトウ」で「佐藤」を検索できる
- ひらがな・カタカナ・漢字 全て対応
- 既存の検索機能（ゼッケン番号、所属）も引き続き利用可能

## ⚙️ セットアップ手順

### ステップ1: Supabaseでデータベースを更新

1. Supabaseにログイン
2. 「SQL Editor」を開く
3. `add_reading_field.sql` の内容をコピー&ペースト
4. 「Run」をクリックして実行

```sql
-- 選手テーブルに読み仮名（ひらがな）フィールドを追加
ALTER TABLE players
ADD COLUMN IF NOT EXISTS reading TEXT;

-- インデックスを追加して検索を高速化
CREATE INDEX IF NOT EXISTS idx_players_reading ON players (reading);
CREATE INDEX IF NOT EXISTS idx_players_name ON players (name);
```

### ステップ2: 既存の選手に読み仮名を登録

1. アプリにログイン（管理者パスワード）
2. 「⚙️ 設定」タブを開く
3. 「登録済み選手」セクションで各選手の「編集」をクリック
4. 「読み仮名（ひらがな）」欄に読み仮名を入力
   - 例: 「田中太郎」 → 「たなかたろう」
   - 例: 「佐藤花子」 → 「さとうはなこ」
5. 「保存」をクリック

### ステップ3: 新規選手登録時

新規選手を追加する際は、以下の項目を入力してください：
- ゼッケン番号（必須）
- 名前（必須）
- 所属（任意）
- **読み仮名（ひらがな）**（任意だが推奨）

## 🔍 検索機能の使い方

「📝 検量入力」タブで：
1. 検索ボックスに入力
2. 以下の方法で検索できます：
   - **読み仮名**: 「たなか」→「田中太郎」がヒット ✅
   - **ひらがな**: 「たなか」→「田中太郎」がヒット ✅
   - **カタカナ**: 「タナカ」→「田中太郎」がヒット ✅
   - **漢字**: 「田中」→「田中太郎」がヒット ✅
   - **ゼッケン番号**: 「5」→ 5番の選手がヒット ✅
   - **所属**: 「西連合」→ 茅ヶ崎西連合の選手がヒット ✅
   - **全角数字**: 「５」→ 5番の選手がヒット ✅
   - **英字（大文字小文字区別なし）**: 「yamada」「YAMADA」 ✅

3. 検索結果がプルダウンに即座に表示されます
4. 検索結果件数が表示されます（緑: 成功、赤: 該当なし）

## ⚠️ 注意事項

### 読み仮名の入力規則
- **必ずひらがなで入力してください**
- カタカナで入力した場合も検索はできますが、ひらがな推奨
- スペースなしで続けて入力: ✅「やまだたろう」 ❌「やまだ たろう」

### 検索のヒント
- 部分一致で検索できます
  - 「たな」→「田中太郎」「田中花子」がヒット
- 全角・半角は自動変換されます
  - 「５」→「5」として検索
  - 「ＡＢＣＤ」→「abcd」として検索

## 🐛 トラブルシューティング

### Q: 「さとう」で検索しても何も出ない
**A:** 選手データに読み仮名が登録されていません。ステップ2を実行してください。

### Q: 読み仮名を入力したのに検索できない
**A:** ブラウザのコンソール（F12）を開いて、以下を確認：
1. 「📋 選手データサンプル」に読み仮名が含まれているか確認
2. 「✅ 読み仮名一致」のログが出力されているか確認

### Q: データベースの更新に失敗する
**A:** Supabaseの権限を確認してください。管理者権限が必要です。

## 📊 データベーススキーマ

```sql
CREATE TABLE players (
    id BIGINT PRIMARY KEY,
    tournament_id TEXT NOT NULL,
    zekken INTEGER NOT NULL,
    name TEXT NOT NULL,
    club TEXT,
    reading TEXT,  -- ← 新しく追加
    created_at TIMESTAMP DEFAULT NOW()
);
```

## 🎉 完了！

これで、ひらがな・カタカナ・漢字 全ての検索が可能になりました！

---

**作成日**: 2026-02-11
**バージョン**: 1.0.0
